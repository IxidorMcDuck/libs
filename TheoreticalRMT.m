BeginPackage["TheoreticalRMT`"] ;

ExactPs::usage =
"This one shows the exact RMT result, i am using tables in Metha and haake (old) interpolation of order 3";

P::usage = 
"This function gives the nearest neighbor distribution for the different \
betas
(beta=1, 2 or 4 posibly zero also)";

IntegratedP::usage = 
"This function gives the integrated nearest neighbor disrtibution for
different betas (beta=1, 2 or 4 posibly zero also)";

Sigma2::usage = 
"This function gives the Sigma 2 statistics for
different betas (beta=1, 2 or 4 posibly zero also)";

Delta2::usage = 
"This function Delta2[s_,Beta_] gives the Delta 2 statistics for
different betas (beta=1, 2 or 4 posibly zero also)";

Gamma1::usage = 
"This function gives the gamma1 statistics for
different betas (beta=0, 1, possibly 2, 4 also)";

Gamma2::usage = 
"This function gives the gamma2 statistics for
different betas (beta=0, 1, possibly 2, 4 also)";

K2::usage = 
"This function gives the K2 form factor for
different betas (beta=1, 2, 4 possibly 0 also)";
ProsenPsGOE::usage =
"This function provides very good Ps, with a polynomial God know
comming from where. If one needs details, ask prosen";
ProsenWsGOE::usage =
"This function provides very good Ws, with a polynomial God know
comming from where. If one needs details, ask prosen";

X2::usage = "X2[4,r_] calculates the level density correlations";

EigenvalueDensity::usage = "EigenvalueDensity[x_, n_] displays the exact eigenvalue
density for different values of the dimension n. Example:
Plot[EigenvalueDensity[x, 4], {x, -5, 5}]"

phiMehta::usage = "Phi required for many functions of the GUE. Defined as equation 6.2.2 of Mehta (Chapter 6)"

Begin["`private`"];

phiMehta[x_, j_] := Exp[-x^2/2]/Sqrt[2^j j! Sqrt[\[Pi]]] HermiteH[j, x]
EigenvalueDensity[x_, n_] := Sum[phiMehta[x, j]^2, {j, 0, n - 1}]

X2[4,r_] := 
 1 - ((Sin[2 Pi r]/(2 Pi r))^2 - (Cos[2 \[Pi] r]/r - Sin[2 \[Pi] r]/(
       2 \[Pi] r^2)) SinIntegral[2 \[Pi] r]/(2 \[Pi]))

tauptmp = {0.`, 1.644934`, 0.`, -1.623485`, 0.3607744`, 
0.5722555`, -0.2034686`, -0.1045914`, 0.051996864000000004`, 
0.011730404000000002`, -0.008401204800000001`, -0.00089057279`, 
0.0010192293999999999`, 0.000043354994000000004`, -0.00010269378`, 
1.4456927999999999`*^-7,8.978810899999998`*^-6,-3.5907897`*^-7,-6.8613429`*^-7, 
5.3373192`*^-8,4.563387900000001`*^-8,-5.3051945`*^-9, -2.6365437`*^-9, 
4.1366746000000004`*^-10,1.3268189`*^-10, -2.6832851999999998`*^-11, 
-5.8466725`*^-12,1.4984853`*^-12,2.267944`*^-13, -7.387109899999999`*^-14,
-7.760615`*^-15,3.2799913`*^-15,2.3256904`*^-16, -1.3336113999999998`*^-16, 
-5.9064989`*^-18,5.030571300000001`*^-18,1.1235767`*^-19, -1.7770689`*^-19, -5.584334`*^-22, 
5.9124696999999994`*^-21, -8.6112536`*^-23, -1.8575824`*^-22,5.877197500000001`*^-24};

tp[i_Integer] := tauptmp[[i + 1]] /; 0<=i<=42;
tw[0] = 0; tw[i_Integer] := tp[i - 1]/i /; 1 <= i <= 43;
pp[s_] := 
Module[{FinalValue}, FinalValue = tp[42]; 
Do[FinalValue = FinalValue s + tp[i], {i, 41, 0, -1}]; FinalValue];
pw[s_] := 
Module[{FinalValue}, FinalValue = tw[43]; 
Do[FinalValue = FinalValue s + tw[i], {i, 42, 0, -1}]; FinalValue]
extendedpp[s_]:=(47253.64346519568*E^(-0.785398163*s - 0.6168502744437745*s^2 - 0.09375/(1 + Pi*s)^3)*(-0.2440331388419025 + s)*
(0.19062810710007644 + s)*(0.3183098861837643 + s)*(0.9122831313606076 + s)*(1.3851923560323345 + s)*
(0.20129198171518686 - 0.14569949364665324*s + s^2)*(0.15923434418282778 + 0.7655975027978533*s + s^2)*
(0.4048450465435129 + 0.9557501697253574*s + s^2))/((1 + Pi*s)^(1/8)*(1. + Pi*s)^9);
extendedpw[s_]:=1 + (0.409003303*E^(-0.785398163*s - 0.6168502744437745*s^2 - 0.09375/(1 + Pi*s)^3)*
(-2 - Pi*s + 2.25/(1 + Pi*s)^4 - 1./(1 + Pi*s)))/(1 + Pi*s)^(1/8)

ProsenPsGOE[s_]:=If[0<=s<=2.58,pp[s],extendedpp[s]];
ProsenWsGOE[s_]:=If[0<=s<=2.4,pw[s],extendedpw[s]];


ExactPs[2,x_]:=Module[{p2,s},
p2={0.,0.01326,.05221,.11438,.19592,
.29186,.39649,.50384,.60804,.70370,
.78628,.89937,.93351,.89288,.79483,
.66302,.52079,.38659,.27194,.18166,
.11543,.06986,.04032,.02221,.01168,
.00588,.00283,.00130,.00057,.00024,
.00010,.00004,.00001,.0,.0};
s={0.000,0.064,0.127,0.191,0.255,
0.318,0.382,0.446,0.509,0.573,
0.637,0.764,0.891,1.019,1.146,
1.273,1.401,1.528,1.655,1.783,
1.910,2.037,2.165,2.292,2.419,
2.546,2.674,2.801,2.928,3.056,
3.183,3.310,3.438,3.565,3.692};
Interpolation[Transpose[{s,p2}],InterpolationOrder->3][x]];
ExactPs[1,x_]:=Module[{p1,s},
p1={0.,.10431,.20620,.30346,.39414,
.47657,.54944,.61178,.66295,.70266,
.73095,.75477,.73965,.69350,.62542,
.54452,.45891,.37514,.29791,.23010,
.17304,.12679,.09058,.06314,.04295,
.02853,.01851,.01173,.00727,.00440,
.00261,.00151,.00085,.000470,.00026};
s={0.000,0.064,0.127,0.191,0.255,
0.318,0.382,0.446,0.509,0.573,
0.637,0.764,0.891,1.019,1.146,
1.273,1.401,1.528,1.655,1.783,
1.910,2.037,2.165,2.292,2.419,
2.546,2.674,2.801,2.928,3.056,
3.183,3.310,3.438,3.565,3.692};
Interpolation[Transpose[{s,p1}],InterpolationOrder->3][x]];


Pgoe[s_] := Pi s/2 Exp[-Pi s^2/4];
Pgue[s_] := 32 s^2/Pi^2 Exp[-4 s^2/Pi];
Pgse[s_] := 2^18 s^4/(3^6 Pi^3) Exp[-64 s^2/(9 Pi)];

P[s_,Beta_]:=Pgoe[s] /; Beta==1;
P[s_,Beta_]:=Pgue[s] /; Beta==2;
P[s_,Beta_]:=Pgse[s] /; Beta==4;


IntegratedPgoe[s_] := 1 - E^(-(Pi*s^2)/4);
IntegratedPgue[s_] := (-4*s)/(E^((4*s^2)/Pi)*Pi) + Erf[(2*s)/Sqrt[Pi]];
IntegratedPgse[s_] := (-16*s*(27*Pi + 128*s^2))/(81*E^((64*s^2)/(9*Pi))*Pi^2) + \
Erf[(8*s)/(3*Sqrt[Pi])];

IntegratedP[s_,Beta_]:=IntegratedPgoe[s] /; Beta==1;
IntegratedP[s_,Beta_]:=IntegratedPgue[s] /; Beta==2;
IntegratedP[s_,Beta_]:=IntegratedPgse[s] /; Beta==4;


Sigma2goe[s_]:=(2*(1 + EulerGamma - Pi^2/8 + Log[2*Pi*s]))/Pi^2;
Sigma2gue[s_]:=(1 + EulerGamma + Log[2*Pi*s])/Pi^2;
Sigma2gse[s_]:=(1 + EulerGamma + Pi^2/8 + Log[4*Pi*s])/(2*Pi^2);

Sigma2[s_,Beta_]:=Sigma2goe[s] /; Beta==1;
Sigma2[s_,Beta_]:=Sigma2gue[s] /; Beta==2;
Sigma2[s_,Beta_]:=Sigma2gse[s] /; Beta==4;

Delta2goe[s_]:= Module[{z},Print["ojo"];
4s/Pi NIntegrate[Sin[z]^2/z^2,{z, s Pi,Infinity},Method->Oscillatory]
+2/Pi^2 NIntegrate[(1-Cos[z])/z,{z,0,2Pi s}]
-1/4
+1/Pi^2(NIntegrate[Sin[z]/z,{z,Pi s,Infinity},Method->Oscillatory])^2];

Delta2gue[s_]:=Module[{z},Print["ojo"];
2s/Pi NIntegrate[Sin[z]^2/z^2,{z, s Pi,Infinity},Method->Oscillatory]
+1/Pi^2 NIntegrate[(1-Cos[z])/z,{z,0,2 Pi s}]];

Delta2gse[s_]:=Module[{z}, Print["ojo"];
s
-1/Pi^2 NIntegrate[(2  Pi s - z) (Sin[z]/z)^2, {z, 0,2 Pi s}] + 
1/(2 Pi^2) (NIntegrate[Sin[z]/z, {z, 0, 2 Pi s}])^2];


(*Esta danado!!
Delta2[s_,Beta_]:= Delta2goe[s] /; Beta==1;
Delta2[s_,Beta_]:= Delta2gue[s] /; Beta==2;
Delta2[s_,Beta_]:= Delta2gse[s] /; Beta==4;*)


Gamma1[0]={{0.2, 2.23606800427402}, {0.4, 1.58113884071228}, {0.6, 1.29099441225229}, 
{0.8, 1.11803400213701}, {1., 1.}, {1.2, 0.9128708949360449}, {1.4, 0.8451542410560235}, 
{1.6, 0.7905694203561394}, {1.8, 0.7453559683109839}, {2., 0.707106793288165}, 
{2.2, 0.6741998295012095}, {2.4, 0.6454972061261463}, {2.6, 0.6201736715287282}, 
{2.8, 0.5976143039744171}, {3., 0.5773502795520422}, {3.2, 0.559017001068506}, 
{3.4, 0.54232614027476}, {3.6, 0.5270462636805808}, {3.8, 0.5129891886864117}, {4., 0.5}, 
{4.2, 0.487949997708174}, {4.4, 0.4767313105660052}, {4.6, 0.4662523983467804}, 
{4.8, 0.4564354474680225}, {5., 0.4472135889338759}, {5.2, 0.438528995549682}, 
{5.4, 0.4303314707507642}, {5.6, 0.4225771205280118}, {5.8, 0.4152273853599099}, 
{6., 0.4082482756069869}, {6.2, 0.401609654325709}, {6.4, 0.3952847101780697}, 
{6.6, 0.3892494748668305}, {6.8, 0.3834824835539173}, {7., 0.3779644834657029}, 
{7.2, 0.372677984155492}, {7.4, 0.3676072927509924}, {7.6, 0.3627381301815514}, 
{7.8, 0.3580574240139238}, {8., 0.3535533966440824}, {8.2, 0.3492151429825791}, 
{8.4, 0.3450327765606624}, {8.6, 0.3409971647417251}, {8.8, 0.3370999147506048}, 
{9., 0.3333333333333333}, {9.2, 0.3296902346919349}, {9.4, 0.3261640252846671}, 
{9.6, 0.3227486030630732}, {9.8, 0.3194382680785414}, {10., 0.3162277621819913}};

Gamma1[1]={{0.127000004, 2.28355742}, {0.254999995, 1.27351594},{0.381999999, 0.807895243}, 
{0.509000003, 0.539663076}, {0.573000014, 0.447045505}, {0.637000024, 0.373764247}, 
{0.890999973, 0.216573536}, {1.14600003, 0.15025343}, {1.40100002, 0.111424007}, 
{1.65499997, 0.0886053294}, {1.90999997, 0.0702425912}, {2.16499996, 0.0574333295}, 
{2.41899991, 0.0518705621}, {2.67400002, 0.043389868}, {2.92799997, 0.0403808095}, 
{3.18300009, 0.0348310173}, {3.43799996, 0.0303384922}, {3.69199991, 0.0293740444}, 
{3.94700003, 0.0251418706}, {4.20200014, 0.0206007753}, {4.45599985, 0.0165389366}, 
{4.71099997, 0.00166170322}, {4.96600008, -0.0300283786}, {5.09299994, -0.0533708856}};

Gamma2[0]={{0.2, 4.9999999254942}, {0.4, 2.4999999627471}, {0.6, 1.66666660043929}, 
{0.8, 1.24999998137355}, {1., 1.}, {1.2, 0.8333333002196431}, {1.4, 0.7142857264499277}, 
{1.6, 0.6249999906867743}, {1.8, 0.555555533479762}, {2., 0.5}, {2.2, 0.4545454446934474}, 
{2.4, 0.4166666501098216}, {2.6, 0.3846153634539735}, {2.8, 0.3571428632249638}, 
{3., 0.3333333333333333}, {3.2, 0.3124999953433872}, {3.4, 0.294117638809046}, 
{3.6, 0.277777766739881}, {3.8, 0.2631578980390386}, {4., 0.25}, {4.2, 0.2380952218762882}, 
{4.4, 0.2272727223467237}, {4.6, 0.2173913088547937}, {4.8, 0.2083333250549108}, {5., 0.2}, 
{5.2, 0.1923076817269867}, {5.4, 0.1851851819146972}, {5.6, 0.1785714316124819}, 
{5.8, 0.1724137874335655}, {6., 0.1666666666666667}, {6.2, 0.1612903151378179}, 
{6.4, 0.1562499976716936}, {6.6, 0.1515151537044865}, {6.8, 0.147058819404523}, 
{7., 0.1428571428571428}, {7.2, 0.1388888833699405}, {7.4, 0.1351351333935824}, 
{7.6, 0.1315789490195193}, {7.8, 0.1282051250701042}, {8., 0.125}, {8.2, 0.1219512223488231}, 
{8.4, 0.1190476109381441}, {8.6, 0.1162790646096578}, {8.8, 0.1136363611733618}, 
{9., 0.1111111111111111}, {9.2, 0.1086956544273968}, {9.4, 0.1063829722475718}, 
{9.6, 0.1041666625274554}, {9.8, 0.1020408143405367}, {10., 0.1}};

Gamma2[1]={{0.127000004, 3.38490653}, {0.254999995, 0.0412003882}, {0.381999999, -0.633194804}, 
{0.509000003, -0.691870213}, {0.573000014, -0.635709047}, {0.637000024, -0.561958194}, 
{0.890999973, -0.279809475}, {1.14600003, -0.16111137}, {1.40100002, -0.13544108}, 
{1.65499997, -0.114253439}, {1.90999997, -0.0921204314}, {2.16499996, -0.0796320513}, 
{2.41899991, -0.0709886253}, {2.67400002, -0.0661418587}, {2.92799997, -0.0608120337}, 
{3.18300009, -0.0562352501}, {3.43799996, -0.0535405204}, {3.69199991, -0.0500185601}, 
{3.94700003, -0.0502071194}, {4.20200014, -0.0520031303}, {4.45599985, -0.0621104389}, 
{4.71099997, -0.0855839923}, {4.96600008, -0.125779957}, {5.09299994, -0.155653238}}

s={0,0.127,0.255,0.382,0.509,0.637,0.891,1.146,1.401,1.655,1.910,2.165,
2.419,2.674,2.928,3.183,3.439,3.692,3.947,4.202,4.456,4.711,4.966,5.093};

a1 = {1,  .87275,  .74647,  .62344,  .50685,  .40008,  .22632,  .11149, 
.04747,  .01739, 0.00547,  .00147,  .00034,  .00007,  .00001, 0, 0, 0, 0, 0, 
0, 0, 0, 0};

a2 = {0.00001, 0.12718, 0.25242, 0.37115, 0.47700, 0.56327, 0.65684, 
0.63644, 0.52729, 0.37809, 0.23561, 0.12759, 0.05991, 0.02433, 
0.00852, 0.00257, 0.00066, 0.00015, 0.00003, 0, 0, 0, 0, 
0};
a3 = {0, 0.00007, 0.00111, 0.00541, 0.01614, 0.03661, 0.11610, 0.24674, 
0.40249, 0.53689, 0.60522, 0.58709, 0.49506, 0.36473, 0.23518, 
0.13262, 0.06528, 0.02796, 0.01040, 0.00335, 0.00093, 0.00022, 
0.00005, 0.00002};

a4 = {0, 0, 0, 0, 0.00001, 0.00004, 0.00074, 0.00533, 0.02270, 0.06717, 
0.15101, 0.27268, 0.40982, 0.52458, 0.58041, 0.56033, 0.47461, 
0.35367, 0.23199, 0.13381, 0.06772, 0.02999, 0.1159, 
0.00684};
a5 = {0, 0, 0, 0, 0, 0, 0, 0, 0.00005, 0.00046, 0.00270, 0.01114, 
0.03468, 0.08518, 0.171074, 0.28814, 0.41494, 0.51765, 0.56466, 
0.54181, 0.45897, 0.34379, 0.22769, 0.17687};
a6 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00002, 0.00019, 0.00111, 
0.00482, 0.01627, 0.04411, 0.09868, 0.18595, 0.29997, 0.41949, 
0.51330, 0.55320, 0.54838};
a7 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00001, 0.00007, 
0.00040, 0.00188, 0.00695, 0.02093, 0.05222, 0.10998, 0.19836, 
0.25230};
a8 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00002, 
0.00013, 0.00066, 0.00271, 0.00908, 0.01549};
a8 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00002, 
0.00013, 0.00066, 0.00271, 0.00908, 0.01549};
a = {s, a1, a2, a3, a4, a5, a6, a7, a8};
E2[n_,i_]:=a[[n+2,i]]
Mu = Table[Sum[(n - s[[i]])^j E2[n, i], {n, 0, 7}], {j, 4}, {i,24}];
Gamma1t=Mu[[3]]Power[Mu[[2]],-3/2];
Gamma2t=Mu[[4]]Power[Mu[[2]],-2]-3;

Gamma1[2]=Transpose[{s,Gamma1t}];
Gamma2[2]=Transpose[{s,Gamma2t}];

K2goe[t_] := If[Abs[t] <= 1, 2*Abs[t] - Abs[t]*Log[2*Abs[t] + 1], 
2 - Abs[t]*Log[(2*Abs[t] + 1)/(2*Abs[t] - 1)]];
K2gue[t_] := If[Abs[t] <= 1, Abs[t], 1];
K2gse[t_] := If[Abs[t] <= 2, (1/2)*Abs[t] - (1/4)*Abs[t]*Log[Abs[1 - Abs[t]]], 1];

K2[s_,Beta_]:=K2goe[s] /; Beta==1;
K2[s_,Beta_]:=K2gue[s] /; Beta==2;
K2[s_,Beta_]:=K2gse[s] /; Beta==4;



Delta2[L_,1]:= Module[{sigma21},
sigma21={{0, 0.}, {0.05, 0.0475555}, {0.1, 0.0905208}, {0.15, 0.1293}, {0.2,
0.164286}, {0.25, 0.195857}, {0.3, 0.224372}, {0.35, 0.250168}, {0.4,
0.273557}, {0.45, 0.294828}, {0.5, 0.31424}, {0.55, 0.332033}, {0.6, 0.348408},
{0.65, 0.363553}, {0.7, 0.377627}, {0.75, 0.39077}, {0.8, 0.403101}, {0.85,
0.414719}, {0.9, 0.425709}, {0.95, 0.436143}, {1., 0.44608}, {1.05, 0.455568},
{1.1, 0.464649}, {1.15, 0.473358}, {1.2, 0.481723}, {1.25, 0.489769}, {1.3,
0.497518}, {1.35, 0.504989}, {1.4, 0.512199}, {1.45, 0.519165}, {1.5,
0.525938}, {1.55, 0.532458}, {1.6, 0.538773}, {1.65, 0.544897}, {1.7, 0.55084},
{1.75, 0.556613}, {1.8, 0.562226}, {1.85, 0.567688}, {1.9, 0.573007}, {1.95,
0.578191}, {2., 0.583248}, {2.05, 0.588183}, {2.1, 0.593002}, {2.15, 0.59771},
{2.2, 0.602314}, {2.25, 0.606815}, {2.3, 0.61122}, {2.35, 0.615532}, {2.4,
0.619754}, {2.45, 0.623889}, {2.5, 0.627942}, {2.55, 0.63186}, {2.6, 0.635755},
{2.65, 0.639576}, {2.7, 0.643325}, {2.75, 0.647007}, {2.8, 0.650622}, {2.85,
0.654174}, {2.9, 0.657664}, {2.95, 0.661096}, {3., 0.66447}, {3.05, 0.667789},
{3.1, 0.671055}, {3.15, 0.674269}, {3.2, 0.677433}, {3.25, 0.680548}, {3.3,
0.683616}, {3.35, 0.686638}, {3.4, 0.689616}, {3.45, 0.69255}, {3.5, 0.695499},
{3.55, 0.698351}, {3.6, 0.701163}, {3.65, 0.703936}, {3.7, 0.706671}, {3.75,
0.709369}, {3.8, 0.712032}, {3.85, 0.71466}, {3.9, 0.717255}, {3.95, 0.719816},
{4., 0.722345}, {4.05, 0.724843}, {4.1, 0.727311}, {4.15, 0.729748}, {4.2,
0.732157}, {4.25, 0.734537}, {4.3, 0.736889}, {4.35, 0.739214}, {4.4,
0.741513}, {4.45, 0.743785}, {4.5, 0.746032}, {4.55, 0.748488}, {4.6,
0.750688}, {4.65, 0.752865}, {4.7, 0.755018}, {4.75, 0.757149}, {4.8,
0.759257}, {4.85, 0.761343}, {4.9, 0.763408}, {4.95, 0.765452}, {5., 0.767475}};
Interpolation[sigma21,InterpolationOrder->3][L]];


Delta2[L_,2]:= Module[{sigma22},
sigma22=
{{0, 0.}, {0.05, 0.0474969}, {0.1, 0.0900416}, {0.15, 0.127755}, {0.2, 
0.160833}, {0.25, 0.189541}, {0.3, 0.214199}, {0.35, 0.235176}, {0.4, 
0.252871}, {0.45, 0.267703}, {0.5, 0.280093}, {0.55, 0.290457}, {0.6, 
0.299182}, {0.65, 0.306632}, {0.7, 0.313126}, {0.75, 0.318939}, {0.8, 
0.324298}, {0.85, 0.329379}, {0.9, 0.334312}, {0.95, 0.339182}, {1., 
0.344036}, {1.05, 0.348887}, {1.1, 0.353726}, {1.15, 0.358524}, {1.2, 
0.363243}, {1.25, 0.36784}, {1.3, 0.372276}, {1.35, 0.376516}, {1.4, 
0.380537}, {1.45, 0.384325}, {1.5, 0.387898}, {1.55, 0.391228}, {1.6, 
0.394353}, {1.65, 0.397299}, {1.7, 0.400098}, {1.75, 0.402782}, {1.8, 
0.405382}, {1.85, 0.407929}, {1.9, 0.410444}, {1.95, 0.412946}, {2., 
0.415443}, {2.05, 0.41794}, {2.1, 0.420434}, {2.15, 0.422917}, {2.2, 
0.425376}, {2.25, 0.4278}, {2.3, 0.430173}, {2.35, 0.432484}, {2.4, 
0.434723}, {2.45, 0.436882}, {2.5, 0.43896}, {2.55, 0.440929}, {2.6, 
0.442849}, {2.65, 0.444702}, {2.7, 0.446497}, {2.75, 0.448247}, {2.8, 
0.449964}, {2.85, 0.451658}, {2.9, 0.453339}, {2.95, 0.455014}, {3., 
0.456687}, {3.05, 0.45836}, {3.1, 0.460032}, {3.15, 0.461698}, {3.2, 
0.463354}, {3.25, 0.464993}, {3.3, 0.466608}, {3.35, 0.468192}, {3.4, 
0.469741}, {3.45, 0.47125}, {3.5, 0.472746}, {3.55, 0.474173}, {3.6, 
0.475561}, {3.65, 0.476914}, {3.7, 0.478237}, {3.75, 0.479535}, {3.8, 
0.480816}, {3.85, 0.482084}, {3.9, 0.483345}, {3.95, 0.484603}, {4., 
0.485859}, {4.05, 0.487116}, {4.1, 0.488372}, {4.15, 0.489625}, {4.2, 
0.490871}, {4.25, 0.492108}, {4.3, 0.493331}, {4.35, 0.494536}, {4.4, 
0.49572}, {4.45, 0.49688}, {4.5, 0.498015}, {4.55, 0.499242}, {4.6, 
0.50033}, {4.65, 0.501396}, {4.7, 0.502444}, {4.75, 0.503477}, {4.8, 
0.504498}, {4.85, 0.505512}, {4.9, 0.506521}, {4.95, 0.507529}, {5., 
0.508535}};
Interpolation[sigma22,InterpolationOrder->3][L]];

Delta2[L_,4]:= Module[{sigma24},
sigma24={{0, 0.}, {0.05, 0.0499728}, {0.1, 0.099572}, {0.15, 0.147898}, {0.2, 
0.193632}, {0.25, 0.23527}, {0.3, 0.271378}, {0.35, 0.300837}, {0.4, 
0.323012}, {0.45, 0.337843}, {0.5, 0.34583}, {0.55, 0.347951}, {0.6, 
0.345502}, {0.65, 0.339938}, {0.7, 0.332698}, {0.75, 0.325086}, {0.8, 
0.318176}, {0.85, 0.312774}, {0.9, 0.309414}, {0.95, 0.308378}, {1., 
0.309722}, {1.05, 0.313309}, {1.1, 0.318839}, {1.15, 0.325876}, {1.2, 
0.333881}, {1.25, 0.342252}, {1.3, 0.350374}, {1.35, 0.357674}, {1.4, 
0.363675}, {1.45, 0.368045}, {1.5, 0.370625}, {1.55, 0.371443}, {1.6, 
0.370696}, {1.65, 0.368722}, {1.7, 0.365947}, {1.75, 0.36284}, {1.8, 
0.359859}, {1.85, 0.357411}, {1.9, 0.355817}, {1.95, 0.355298}, {2., 
0.355961}, {2.05, 0.357803}, {2.1, 0.360714}, {2.15, 0.364492}, {2.2, 
0.368861}, {2.25, 0.373497}, {2.3, 0.378055}, {2.35, 0.382206}, {2.4, 
0.385663}, {2.45, 0.388217}, {2.5, 0.389751}, {2.55, 0.390253}, {2.6, 
0.389815}, {2.65, 0.388614}, {2.7, 0.386895}, {2.75, 0.38494}, {2.8, 
0.383035}, {2.85, 0.381448}, {2.9, 0.3804}, {2.95, 0.380051}, {3., 
0.380491}, {3.05, 0.381729}, {3.1, 0.383703}, {3.15, 0.386284}, {3.2, 
0.389287}, {3.25, 0.392491}, {3.3, 0.395658}, {3.35, 0.398556}, {3.4, 
0.400983}, {3.45, 0.402787}, {3.5, 0.403878}, {3.55, 0.40424}, {3.6, 
0.403929}, {3.65, 0.403066}, {3.7, 0.401821}, {3.75, 0.400393}, {3.8, 
0.398993}, {3.85, 0.397818}, {3.9, 0.397037}, {3.95, 0.396775}, {4., 
0.397103}, {4.05, 0.398036}, {4.1, 0.399529}, {4.15, 0.401489}, {4.2, 
0.403777}, {4.25, 0.406224}, {4.3, 0.40865}, {4.35, 0.410876}, {4.4, 
0.412746}, {4.45, 0.414139}, {4.5, 0.414986}, {4.55, 0.415269}, {4.6, 
0.415028}, {4.65, 0.414355}, {4.7, 0.413378}, {4.75, 0.412254}, {4.8, 
0.411147}, {4.85, 0.410214}, {4.9, 0.409592}, {4.95, 0.409382}, {5., 
0.409643}};
Interpolation[sigma24,InterpolationOrder->3][L]];
End[];
EndPackage[]

